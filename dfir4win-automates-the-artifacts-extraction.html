<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>DFIR4win - Automates the artifacts extraction - Cibersec and hacking blog</title><meta name="description" content="Manually extracting artefacts from an infected computer can sometimes be tedious with so much information to search for, documents and logs. That's why the less time it&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="gdpr-blocker/">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','G-2WG99B8B6N');</script><link rel="canonical" href="https://b4shnhawx.github.io/dfir4win-automates-the-artifacts-extraction.html"><link rel="alternate" type="application/atom+xml" href="https://b4shnhawx.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://b4shnhawx.github.io/feed.json"><meta property="og:title" content="DFIR4win - Automates the artifacts extraction"><meta property="og:image" content="https://b4shnhawx.github.io/media/posts/5/dfir4win.png"><meta property="og:image:width" content="756"><meta property="og:image:height" content="350"><meta property="og:site_name" content="Cibersec and hacking blog"><meta property="og:description" content="Manually extracting artefacts from an infected computer can sometimes be tedious with so much information to search for, documents and logs. That's why the less time it&hellip;"><meta property="og:url" content="https://b4shnhawx.github.io/dfir4win-automates-the-artifacts-extraction.html"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://b4shnhawx.github.io/media/website/logo_looka_redonded.png" type="image/x-icon"><link rel="stylesheet" href="https://b4shnhawx.github.io/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="https://b4shnhawx.github.io/assets/css/style.css?v=9431fd58192e197cc3a29ad7dc65210b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://b4shnhawx.github.io/dfir4win-automates-the-artifacts-extraction.html"},"headline":"DFIR4win - Automates the artifacts extraction","datePublished":"2024-08-19T19:28","dateModified":"2024-08-21T00:07","image":{"@type":"ImageObject","url":"https://b4shnhawx.github.io/media/posts/5/dfir4win.png","height":350,"width":756},"description":"Manually extracting artefacts from an infected computer can sometimes be tedious with so much information to search for, documents and logs. That's why the less time it&hellip;","author":{"@type":"Person","name":"b4shnhawx","url":"https://b4shnhawx.github.io/authors/b4shnhawx/"},"publisher":{"@type":"Organization","name":"b4shnhawx"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload post-template"><script>document.addEventListener("DOMContentLoaded", function() {
    // Selecciona el contenedor donde quieres insertar el HTML
    var sidebarInner = document.querySelector('#sidebar .inner');

    // Crea el contenedor principal que contendrá el logo y el texto
    var mainContainer = document.createElement('div');
    mainContainer.style.position = "absolute";  // Posición absoluta para que el contenedor se ajuste correctamente
    mainContainer.style.top = "0";  // Alinea el contenedor al borde superior del sidebar
    mainContainer.style.left = "0";  // Alinea el contenedor al borde izquierdo del sidebar
    mainContainer.style.width = "100%";  // Asegura que el contenedor ocupe todo el ancho del sidebar
    mainContainer.style.height = "150px";  // Define la altura del contenedor
    mainContainer.style.zIndex = "2";  // Asegura que el contenedor esté por encima de otros elementos
    mainContainer.style.overflow = "hidden";  // Evita que el contenido desborde

    // Crea el fondo difuminado
    var backgroundContainer = document.createElement('div');
    backgroundContainer.style.position = "absolute";
    backgroundContainer.style.top = "0";
    backgroundContainer.style.left = "0";
    backgroundContainer.style.width = "100%";
    backgroundContainer.style.height = "100%";
    backgroundContainer.style.backgroundImage = "url('https://github.com/b4shnhawx/b4shnhawx.github.io/raw/main/media/files/header_bg.jpg')";
    backgroundContainer.style.backgroundSize = "cover";  // Asegura que la imagen cubra todo el contenedor
    backgroundContainer.style.backgroundPosition = "center";  // Centra la imagen
    backgroundContainer.style.filter = "blur(2.5px)";  // Aplica un efecto de difuminado más ligero
    backgroundContainer.style.zIndex = "1";  // Coloca el fondo detrás del contenido

    // Crea el contenedor para el logo y el texto
    var contentContainer = document.createElement('div');
    contentContainer.style.display = "flex";  // Alinea los elementos horizontalmente
    contentContainer.style.gap = "10px";  // Espacio entre los contenedores
    contentContainer.style.width = "100%";  // Asegura que el contenedor ocupe el 100% del ancho disponible
    contentContainer.style.height = "100%";  // Asegura que el contenedor ocupe el 100% de la altura disponible
    contentContainer.style.zIndex = "2";  // Coloca el contenido por encima del fondo
    contentContainer.style.position = "relative";  // Asegura que el contenido esté correctamente posicionado

    // Crea el contenedor del logo
    var logoContainer = document.createElement('div');
    logoContainer.style.width = "150px";
    logoContainer.style.height = "150px";
    logoContainer.style.overflow = "hidden";  // Evita desbordamiento
    logoContainer.style.display = "flex";  // Asegura centrado
    logoContainer.style.alignItems = "center";
    logoContainer.style.justifyContent = "center";

    // Crea el elemento de imagen
    var logoImg = document.createElement('img');
    logoImg.src = "https://avatars2.githubusercontent.com/u/45437051?s=460&u=b4c1990041dd9e22c0df3f87c93b820f364c2988&v=4";
    logoImg.alt = "Fazt Logo";
    logoImg.classList.add('logo-sidebar');

    // Añade la imagen al contenedor del logo
    logoContainer.appendChild(logoImg);

    // Crea el contenedor del texto
    var textContainer = document.createElement('div');
    textContainer.style.width = "150px";
    textContainer.style.height = "150px";
    textContainer.style.display = "flex";  // Asegura centrado vertical
    textContainer.style.alignItems = "center";
    textContainer.style.justifyContent = "flex-start";  // Alinea el contenido a la izquierda
    textContainer.style.paddingLeft = "10px";  // Añade un poco de espacio desde el borde izquierdo

    // Crea el elemento de texto
    var textElement = document.createElement('div');
    textElement.textContent = "#b4shnhawx";
    textElement.style.fontSize = "27px";  // Aumenta el tamaño del texto
    textElement.style.textAlign = "left";  // Justifica el texto a la izquierda
    textElement.style.color = "#fff";  // Color blanco para que el texto sea visible

    // Añade el texto al contenedor del texto
    textContainer.appendChild(textElement);

    // Añade el contenedor del logo y el contenedor del texto al contenedor de contenido
    contentContainer.appendChild(logoContainer);
    contentContainer.appendChild(textContainer);

    // Añade el fondo difuminado al contenedor principal
    mainContainer.appendChild(backgroundContainer);

    // Añade el contenedor del contenido al contenedor principal
    mainContainer.appendChild(contentContainer);

    // Inserta el contenedor principal al inicio del contenedor de la barra lateral
    sidebarInner.insertBefore(mainContainer, sidebarInner.firstChild);

    // Crea un espaciador para evitar que el contenido de la sidebar se superponga
    var spacer = document.createElement('div');
    spacer.style.height = "100px";  // La misma altura que el contenedor principal

    // Inserta el espaciador después del contenedor principal
    sidebarInner.insertBefore(spacer, mainContainer.nextSibling);
});</script><script>document.addEventListener("DOMContentLoaded", function() {
    // Selecciona el contenedor de la barra lateral y el footer
    var sidebarInner = document.querySelector('#sidebar .inner');
    var footer = document.querySelector('#footer');

    // Selecciona el elemento que deseas mover
    var searchDiv = document.querySelector('#search.alt');

    // Verifica que el elemento exista antes de moverlo
    if (searchDiv) {
        // Crea el encabezado h2 con la clase major
        var searchHeader = document.createElement('header');
        searchHeader.classList.add('major');

        var searchTitle = document.createElement('h2');
        searchTitle.textContent = "Search for any post...";
        searchTitle.style.marginBottom = "15px";  // Añade espacio debajo del texto

        // Añade el h2 al encabezado
        searchHeader.appendChild(searchTitle);

        // Mueve el elemento de búsqueda justo antes del footer
        sidebarInner.insertBefore(searchDiv, footer);

        // Inserta el encabezado justo antes del cuadro de búsqueda
        sidebarInner.insertBefore(searchHeader, searchDiv);
    }
});</script><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://b4shnhawx.github.io/"><strong>Cibersec and hacking blog</strong></a><ul class="icons"><li><a href="https://x.com/_Myrtivheal" class="icon brands fa-x-twitter"><span class="label">Twitter</span></a></li><li><a href="https://www.linkedin.com/in/darribash/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li><li><a href="https://www.youtube.com/channel/UCxvS-XzNNYFOq45-ScuLrxA" class="icon brands fa-youtube"><span class="label">YouTube</span></a></li></ul></header><article class="post"><header class="main post__header"><time datetime="2024-08-19T19:28" class="post__date">August 19, 2024</time><h1>DFIR4win - Automates the artifacts extraction</h1></header><figure class="image main normal"><img src="https://b4shnhawx.github.io/media/posts/5/dfir4win.png" srcset="https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-xs.png 300w, https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-sm.png 480w, https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-md.png 768w, https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-lg.png 1024w, https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-xl.png 1360w, https://b4shnhawx.github.io/media/posts/5/responsive/dfir4win-xxl.png 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="350" width="756" alt=""></figure><div class="post__inner post__entry"><p>Manually extracting artefacts from an infected computer can sometimes be tedious with so much information to search for, documents and logs. That's why the less time it takes to extract the most relevant information, the longer we can spend looking for any clues or evidence.<br><br>With this idea in mind I found in Github a script that looked very good from the user <a href="https://github.com/AlrikRr">AlrikRr</a> (I invite you to take a look at his cool projects), specifically I'm talking about <a href="https://github.com/AlrikRr/Forensic-Extract">Forensic-Extract</a>.</p><p>Looking at his project I thought <em>"OK, it extracts very useful information and records, but... what if I add the option to extract hives?"</em>, so I took advantage of it and made a few more changes:<br><br></p><ul><li>Translated the code into English</li><li>Optimised the code as much as I could</li><li>Added the option to extract hives</li><li>Added a Microsoft Defender status checker</li></ul><p>You can see the project in my Github: <a href="https://github.com/b4shnhawx/DFIR4win/tree/main">b4shnhawx/DFIR4win</a></p><p> </p><figure class="post__image"><img loading="lazy" src="https://b4shnhawx.github.io/media/posts/5/dfir4win_demo_noav.gif" alt="" width="774" height="486"></figure><p> </p><p>DFIR4win can automate the collection of most of the data you need to analyse activity on a Windows machine and compress it all into a ZIP file.<br>It includes:</p><p> </p><ul><li>Relevant host information</li><li>Event logs</li><li>Log hives (for more details, see Microsoft documentation)</li></ul><p><br>If you want to extract the hives, you may need to disable the real-time protection of your antivirus (AV), as it may consider the action suspicious. By default, Windows uses Windows Defender.</p><p><br>This script detects whether your active AV is Windows Defender or some other third-party antivirus. If it is the latter, it is possible that other modules of your AV are blocking the extraction of the files, so I recommend you to manually check if all the files you need have been extracted correctly.</p><p><br>If the script is not working properly to extract the files, you can do it manually with a program (such as Eric Zimmerman's Registry Explorer).</p><p> </p><p>This would be the final directory tree:<br><br></p><pre class="language-bash"><code>./HOST_DD-MM-YYYY.zip
 |
 |-- REGS
 |    |-- *_HOST_DD-MM-YYYY.evtx
 |
 |-- HIVES
 |    |-- Security.hiv
 |    |-- SAM.hiv
 |    |-- DEFAULT.hiv
 |    |-- NTUSER_USERNAME.DAT
 |    |-- System.hiv
 |    |-- USRCLASS_USERNAME.DAT
 |    |-- Software.hiv
 |
 |-- Host-Info_HOST_DD-MM-YYYY.txt</code></pre><p> </p><p>You have all the information about how the script works in the repository 😁</p><p> </p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on August 21, 2024</p><div class="post__share"><h3>Share post:</h3><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fb4shnhawx.github.io%2Fdfir4win-automates-the-artifacts-extraction.html&amp;via=%40_Myrtivheal&amp;text=DFIR4win%20-%20Automates%20the%20artifacts%20extraction" class="js-share icon brands fa-x-twitter" rel="nofollow noopener noreferrer"><span class="label">Twitter</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fb4shnhawx.github.io%2Fdfir4win-automates-the-artifacts-extraction.html" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=DFIR4win%20-%20Automates%20the%20artifacts%20extraction https%3A%2F%2Fb4shnhawx.github.io%2Fdfir4win-automates-the-artifacts-extraction.html" class="js-share icon brands fa-whatsapp" rel="nofollow noopener noreferrer"><span class="label">WhatsApp</span></a></div><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://b4shnhawx.github.io/tags/deffensive/">deffensive</a></li><li><a href="https://b4shnhawx.github.io/tags/hacking/">hacking</a></li><li><a href="https://b4shnhawx.github.io/tags/os/">os</a></li><li><a href="https://b4shnhawx.github.io/tags/powershell/">powershell</a></li><li><a href="https://b4shnhawx.github.io/tags/programming/">programming</a></li><li><a href="https://b4shnhawx.github.io/tags/windows/">windows</a></li></ul></div></footer></article><div class="comments-area"><div class="post__inner"><div class="comments"><div class="comments-wrapper"><h2>Comments</h2><div id="graphcomment"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var __semio__params = {
							graphcommentId: "",
							behaviour: {
								uid: "5"
							}
						}

						function __semio__onload() {
							__semio__gc_graphlogin(__semio__params)
						}
						
						
			(function() {
				var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
				gc.onload = __semio__onload; gc.defer = true; gc.src = 'https://integration.graphcomment.com/gc_graphlogin.js?' + Date.now();
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
			})();</script><script type="text/javascript"></script></div></div></div></div><div class="banner banner--after-post"><div class="wrapper"><div id="graphcomment"></div><script type="text/javascript">/* - - - CONFIGURATION VARIABLES - - - */

  var __semio__params = {
    graphcommentId: "b4shnhawx-github-io", // make sure the id is yours

    behaviour: {
      // HIGHLY RECOMMENDED
      //  uid: "...", // uniq identifer for the comments thread on your page (ex: your page id)
    },

    // configure your variables here
    "sidePanel": {
      "width": 480,
      "button": {
        "background": "#313841",
        "color": "#e0e0e0",
    	"width": 1000,
        "label": "Leave a comment"
      },
      "visible": false
    }
  }

  /* - - - DON'T EDIT BELOW THIS LINE - - - */

  function __semio__onload() {
    __semio__gc_sidePanel_graphlogin(__semio__params)
  }


  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.onload = __semio__onload; gc.defer = true; gc.src = 'https://integration.graphcomment.com/gc_sidePanel_graphlogin.js?' + Date.now();
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();</script></div></div></div></div><div id="sidebar"><div class="inner"><div id="search" class="alt"><form action="https://b4shnhawx.github.io/search.html" class="search__form"><input class="search__input" type="search" name="q" placeholder="search..." aria-label="search..." autofocus required> <button type="submit" class="search__button"><span>Submit</span></button></form></div><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li><a href="https://b4shnhawx.github.io/" target="_self">HOME</a></li><li><a href="https://b4shnhawx.github.io/authors/b4shnhawx/" target="_self">ABOUT ME</a></li><li class="has-submenu"><a href="https://b4shnhawx.github.io/tags/" target="_self" aria-haspopup="true" class="opener">CATEGORIES</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://b4shnhawx.github.io/tags/offensive/" target="_self">HACKING OFFENSIVE</a></li><li><a href="https://b4shnhawx.github.io/tags/deffensive/" target="_self">HACKING DEFFENSIVE</a></li><li><a href="https://b4shnhawx.github.io/tags/flipperzero/" target="_self">FLIPPER ZERO</a></li><li><a href="https://b4shnhawx.github.io/tags/programming/" target="_self">PROGRAMMING</a></li><li><a href="https://b4shnhawx.github.io/tags/linux/" target="_self">LINUX</a></li><li><a href="https://b4shnhawx.github.io/tags/windows/" target="_self">WINDOWS</a></li><li><a href="https://b4shnhawx.github.io/tags/networking/" target="_self">NETWORKING</a></li><li><a href="https://b4shnhawx.github.io/tags/cheatsheets/" target="_self">CHEATSHEETS</a></li><li><a href="https://b4shnhawx.github.io/tags/personal/" target="_self">PERSONAL</a></li><li><a href="https://b4shnhawx.github.io/tags/raspberrypi/" target="_self">RASPBERRY PI</a></li></ul></li><li><a href="https://b4shnhawx.github.io/tags/" target="_self">PROJECTS</a></li></ul></nav><section><header class="major"><h2>Get in touch</h2></header><p class="align-center">--== My area of expertise ==--</p><p class="align-center"> </p><p class="align-center">🛡 Deffensive Cibersecurity 🛡</p><p class="align-center">♦️       Incident Response      ♦️<br>♦️         Threat Hunting         ♦️<br>♦️   Python and Powershell   ♦️<br>♦️          Bash and Linux         ♦️</p><p> </p><p>Contact me for any issues :D</p><p><a href="mailto:davidarribash@gmail.com">davidarribash[@]gmail[.]com</a></p></section><footer id="footer"><p class="copyright">© b4shnhawx 2024 - All rights reserved</p></footer></div></div></div><script src="https://b4shnhawx.github.io/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://b4shnhawx.github.io/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://b4shnhawx.github.io/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://b4shnhawx.github.io/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://b4shnhawx.github.io/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script></body></html>